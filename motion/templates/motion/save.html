<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Gem vægtmåling</title>
</head>

<body>
    <div class="container mt-5">
        <div class="row justify-content-md-center">
            <div class="col-md-6">
                <h2>Gem vægtmåling</h2>
                <form method="post" id="weightForm">
                    {% csrf_token %}
                    
                    <div class="mb-3">
                        <label for="DateTime" class="form-label">Dato og Tid</label>
                        <input type="datetime-local" class="form-control" id="DateTime" name="DateTime" value="{{ datetime }}" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="Date" class="form-label">Dato</label>
                        <input type="date" class="form-control" id="Date" name="Date" value="{{ date }}" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="Weight" class="form-label">Vægt (kg)</label>
                        <input type="number" step="0.1" class="form-control" name="Weight" id="Weight" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="Fat" class="form-label">Fedt (%)</label>
                        <input type="number" step="0.1" class="form-control" name="Fat" id="Fat">
                    </div>
                    
                    <div class="mb-3">
                        <label for="Height" class="form-label">Højde (cm)</label>
                        <input type="number" step="0.1" class="form-control" name="Height" id="Height">
                    </div>
                    
                    <div class="mb-3">
                        <label for="Age" class="form-label">Alder</label>
                        <input type="number" class="form-control" name="Age" id="Age">
                    </div>
                    
                    <div class="mb-3">
                        <label for="Bone" class="form-label">Knogler (kg)</label>
                        <input type="number" step="0.1" class="form-control" name="Bone" id="Bone">
                    </div>
                    
                    <div class="mb-3">
                        <label for="Muscle" class="form-label">Muskler (kg)</label>
                        <input type="number" step="0.1" class="form-control" name="Muscle" id="Muscle">
                    </div>
                    
                    <div class="mb-3">
                        <label for="Vfat" class="form-label">Visceralt fedt</label>
                        <input type="number" step="0.1" class="form-control" name="Vfat" id="Vfat">
                    </div>
                    
                    <div class="mb-3">
                        <label for="Moisture" class="form-label">Fugtighed (%)</label>
                        <input type="number" step="0.1" class="form-control" name="Moisture" id="Moisture">
                    </div>
                    
                    <div class="mb-3">
                        <label for="Calorie" class="form-label">Kalorier</label>
                        <input type="number" class="form-control" name="Calorie" id="Calorie">
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Gem</button>
                    <a href="{% url 'motion:index' %}" class="btn btn-secondary">Annuller</a>
                </form>
                <div id="message" class="mt-3"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('weightForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            fetch('', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                }
            })
            .then(response => response.json())
            .then(data => {
                const messageDiv = document.getElementById('message');
                if (data.success) {
                    messageDiv.innerHTML = '<div class="alert alert-success" role="alert">' + data.message + '</div>';
                    setTimeout(() => {
                        window.location.href = '{% url "motion:index" %}';
                    }, 1500);
                } else {
                    messageDiv.innerHTML = '<div class="alert alert-danger" role="alert">Fejl: ' + data.error + '</div>';
                }
            })
            .catch(error => {
                document.getElementById('message').innerHTML = '<div class="alert alert-danger" role="alert">Fejl ved indsendelse: ' + error + '</div>';
            });
        });
    </script>
</body>

</html>
